# Readme

This document is an appendix to the FAQ "How to automate deployment to a Docker container by using Jenkins". The Jenkins pipeline scripts detailed here (\*.groovy) refer to the Windows PowerShell scripts (\*.ps1) that perform the Docker automation.

The paths variables (**baseJenkinsPath** and **networkPath**) assume the paths are used as in the tutorial: `C:\jenkins` for local paths; `\\containers.domain.example.com\jenkins\` for the network share path. This is also the case for the **ContainerRun** pipeline and the **MachineFullyQualifiedName** parameter (it assumes the address is `site.domain.example.com`). Modify these to fit your scenario.

Notice the string replacement for the paths **Target**, **Results**, and **Configs**. This is to guarantee that each path representation is local and not a network share. In practical terms, only the **Configs** path requires this, as Docker can't mount volumes to paths represented as network shares. The other two paths are modified for the sake of consistency.

## Container Build Script

ContainerBuild.ps1 unzips the bundle, ensures that a docker image is built and creates the .preparedone marker file.

## Container Run Script

ContainerRun.ps1 stops containers running previous versions of the application, ensures that a new container is running, creates the rewrite rules and finally the .deploydone marker file.

## Container Remove Script

ContainerRemove.ps1 stops any containers running the application, removes any rewrite rules specific to the app, and cleans up any leftover bundles, unzipped folders and marker files.

## Update Configurations Script

Due to the specificity of sample setup, the containers use directly the config folder generated by the deployment process as their configs volume. As the application inside the container checks for changes in the configuration file and automatically reloads them, this means that not much needs to be done by this hook: just write the .configsdone file.
